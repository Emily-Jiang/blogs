---
layout: post
title: "Enhancements for MicroProfile Metrics and a new training course in 24.0.0.7"
# Do NOT change the categories section
categories: blog
author_picture: https://avatars3.githubusercontent.com/dmuelle
author_github: https://github.com/dmuelle
seo-title: Enhancements for MicroProfile Metrics and a new training course in 24.0.0.7 - OpenLiberty.io
seo-description: The 24.0.0.7 release includes enhancements for histogram and timer metrics in MicroProfile 3.0 and 4.0. Also, a new beginner-level training course is now available to teach you the essentials of cloud native Java application development with Open Liberty.
blog_description: The 24.0.0.7 release includes enhancements for histogram and timer metrics in MicroProfile 3.0 and 4.0. Also, a new beginner-level training course is now available to teach you the essentials of cloud native Java application development with Open Liberty.
open-graph-image: https://openliberty.io/img/twitter_card.jpg
open-graph-image-alt: Open Liberty Logo
---
= Enhancements for MicroProfile Metrics and a new training course in 24.0.0.7
David Mueller <https://github.com/dmuelle>
:imagesdir: /
:url-prefix:
:url-about: /
//Blank line here is necessary before starting the body of the post.

// // // // // // // //
// In the preceding section:
// Do not insert any blank lines between any of the lines.
// Do not remove or edit the variables on the lines beneath the author name.
//
// "open-graph-image" is set to OL logo. Whenever possible update this to a more appropriate/specific image (For example if present a image that is being used in the post). However, it
// can be left empty which will set it to the default
//
// "open-graph-image-alt" is a description of what is in the image (not a caption). When changing "open-graph-image" to
// a custom picture, you must provide a custom string for "open-graph-image-alt".
//
// Replace TITLE with the blog post title eg: MicroProfile 3.3 is now available on Open Liberty 20.0.0.4
// Replace dmuelle with your GitHub username eg: lauracowen
// Replace DESCRIPTION with a short summary (~60 words) of the release (a more succinct version of the first paragraph of the post).
// Replace David Mueller with your name as you'd like it to be displayed, eg: Laura Cowen
//
// Example post: 2020-04-09-microprofile-3-3-open-liberty-20004.adoc
//
// If adding image into the post add :
// -------------------------
// [.img_border_light]
// image::img/blog/FILE_NAME[IMAGE CAPTION ,width=70%,align="center"]
// -------------------------
// "[.img_border_light]" = This adds a faint grey border around the image to make its edges sharper. Use it around screenshots but not
// around diagrams. Then double check how it looks.
// There is also a "[.img_border_dark]" class which tends to work best with screenshots that are taken on dark
// backgrounds.
// Change "FILE_NAME" to the name of the image file. Also make sure to put the image into the right folder which is: img/blog
// change the "IMAGE CAPTION" to a couple words of what the image is
// // // // // // // //

The 24.0.0.7 release includes enhancements for histogram and timer metrics in MicroProfile 3.0 and 4.0. Also, a new beginner-level training course is now available to teach you the essentials of cloud native Java application development with Open Liberty.

// // // // // // // //
// In the preceding section:
// Leave any instances of `tag::xxxx[]` or `end:xxxx[]` as they are.
//
// Replace RELEASE_SUMMARY with a short paragraph that summarises the release. Start with the lead feature but also summarise what else is new in the release. You will agree which will be the lead feature with the reviewers so you can just leave a placeholder here until after the initial review.
// // // // // // // //

// // // // // // // //
// Replace the following throughout the document:
//   Replace 24.0.0.7 with the version number of Open Liberty, eg: 22.0.0.2
//   Replace 24007 with the version number of Open Liberty wihtout the periods, eg: 22002
// // // // // // // //

In link:{url-about}[Open Liberty] 24.0.0.7:

* <<mpm, Enhanced histogram and timer metrics in MicroProfile 3.0 and 4.0>>
* <<course, Learn to develop applications with Open Liberty in the new "Essentials for Cloud-Native Java Application Development" course>>
* <<CVEs, Security Vulnerability (CVE) Fixes>>

View the list of fixed bugs in link:https://github.com/OpenLiberty/open-liberty/issues?q=label%3Arelease%3A24007+label%3A%22release+bug%22[24.0.0.7].

Check out link:{url-prefix}/blog/?search=release&search!=beta[previous Open Liberty GA release blog posts].


[#run]


== Develop and run your apps using 24.0.0.7

If you're using link:{url-prefix}/guides/maven-intro.html[Maven], include the following in your `pom.xml` file:

[source,xml]
----
<plugin>
    <groupId>io.openliberty.tools</groupId>
    <artifactId>liberty-maven-plugin</artifactId>
    <version>3.10.3</version>
</plugin>
----

Or for link:{url-prefix}/guides/gradle-intro.html[Gradle], include the following in your `build.gradle` file:

[source,gradle]
----
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'io.openliberty.tools:liberty-gradle-plugin:3.8.3'
    }
}
apply plugin: 'liberty'
----

Or if you're using link:{url-prefix}/docs/latest/container-images.html[container images]:

[source]
----
FROM icr.io/appcafe/open-liberty
----

Or take a look at our link:{url-prefix}/start/[Downloads page].

If you're using link:https://plugins.jetbrains.com/plugin/14856-liberty-tools[IntelliJ IDEA], link:https://marketplace.visualstudio.com/items?itemName=Open-Liberty.liberty-dev-vscode-ext[Visual Studio Code] or link:https://marketplace.eclipse.org/content/liberty-tools[Eclipse IDE], you can also take advantage of our open source link:https://openliberty.io/docs/latest/develop-liberty-tools.html[Liberty developer tools] to enable effective development, testing, debugging and application management all from within your IDE.

[link=https://stackoverflow.com/tags/open-liberty]
image::img/blog/blog_btn_stack.svg[Ask a question on Stack Overflow, align="center"]

// // // // DO NOT MODIFY THIS COMMENT BLOCK <GHA-BLOG-TOPIC> // // // //
// Blog issue: https://github.com/OpenLiberty/open-liberty/issues/28982
// Contact/Reviewer: tonyreigns
// // // // // // // //
[#mpm]
== Enhanced histogram and timer metrics in MicroProfile 3.0 and 4.0

This release introduces MicroProfile Config properties for MicroProfile 3.0 and 4.0 that are used for configuring the statistics that are tracked and outputted by the histogram and timer metrics. These changes are already available in MicroProfile Metrics 5.1.

In previous MicroProfile Metrics 3.0 and 4.0 releases, histogram and timer metrics tracked only the following values:

* Min/max recorded values
* The sum of all values
* The count of the recorded values
* A static set of percentiles for the 50th, 75th, 95th, 98th, 99th and 99.9th percentile.

These values are output to the `/metrics` endpoint in Prometheus format.

The new properties can define a custom set of percentiles as well as custom set of histogram buckets for the histogram and timer metrics. Other new configuration properties can enable a default set of histogram buckets, including properties that define an upper and lower bound for the bucket set.

With these properties, you can define a semicolon-separated list of value definitions that use the following syntax:

----
<metric name>=<value-1>[,<value-2>â€¦<value-n>]
----

Some properties can accept multiple values for a given metric name, while others can accept only a single value.

You can use an asterisk ( *) as a wildcard at the end of the metric name.

[cols="2*"]
|===
| Property  | Description
| mp.metrics.distribution.percentiles | Defines a custom set of percentiles for matching Histogram and Timer metrics to track and output. Accepts a set of integer and decimal values for a metric name pairing. Can be used to disable percentile output if no value is provided with a metric name pairing.
| mp.metrics.distribution.histogram.buckets| Defines a custom set of (cumulative) histogram buckets for matching Histogram metrics to track and output.  Accepts a set of integer and decimal values for a metric name pairing.
| mp.metrics.distribution.timer.buckets| Defines a custom set of (cumulative) histogram buckets for matching Timer metrics to track and output.  Accepts a set of decimal values with a time unit appended (that is, ms, s, m, h) for a metric name pairing.
|mp.metrics.distribution.percentiles-histogram.enabled | Configures any matching Histogram or Timer metric to provide a large set of default histogram buckets to allow for percentile configuration with a monitoring tool. Accepts a true/false value for a metric name pairing.
| mp.metrics.distribution.histogram.max-value| When percentile-histogram is enabled for a Timer, this property defines an upper bound for the buckets reported. Accepts a single integer or decimal value for a metric name pairing.
| mp.metrics.distribution.histogram.min-value| When percentile-histogram is enabled for a Timer, this property defines a lower bound for the buckets reported. Accepts a single integer or decimal value for a metric name pairing.
|mp.metrics.distribution.timer.max-value | When percentile-histogram is enabled for a Histogram, this property defines an upper bound for the buckets reported. Accepts a single decimal value with a time unit appended (that is, ms, s, m, h) for a metric name pairing. Accepts a single decimal value with a time unit appended (that is, ms, s, m, h) for a metric name pairing.
|mp.metrics.distribution.timer.min-value | When percentile-histogram is enabled for a Histogram, this property defines a lower bound for the buckets reported. Accepts a single decimal value with a time unit appended (that is, ms, s, m, h) for a metric name pairing.

|===

You can define the `mp.metrics.distribution.percentiles` property similar to the following example.

----
mp.metrics.distribution.percentiles=alpha.timer=0.5,0.7,0.75,0.8;alpha.histogram=0.8,0.85,0.9,0.99;delta.*=
----

This property creates the `alpha.timer` timer metric to track and output the 50th, 70th, 75th, and 80th percentile values. The `alpha.histogram` histogram metric outputs the 80th, 85th, 90th, and 99th percentile values. Percentiles for any histogram or timer metric that matches with `delta.*` are disabled.

We'll expand on this example and define histogram buckets for the `alpha.timer` timer metric by using the `mp.metrics.distribution.timer.buckets` property.

----
mp.metrics.distribution.timer.buckets=alpha.timer=100ms,200ms,1s
----

This configuration tells the metrics runtime to track and output the count of durations that fall within 0-100ms, 0-200ms and 0-1 seconds. This output is due to the histogram buckets working in a _cumulative_ fashion.

The corresponding prometheus output for the `alpha.timer` metric at the `/metrics` REST endpoint is similar to the following example:

----
# TYPE application_alpha_timer_mean_seconds gauge
application_alpha_timer_mean_seconds 2.9700022497975187
# TYPE application_alpha_timer_max_seconds gauge
application_alpha_timer_max_seconds 5.0
# TYPE application_alpha_timer_min_seconds gauge
application_alpha_timer_min_seconds 1.0
# TYPE application_alpha_timer_stddev_seconds gauge
application_alpha_timer_stddev_seconds 1.9997750210918204
# TYPE alpha_timer_seconds histogram <1>
application_alpha_timer_seconds_bucket{le="0.1"} 0.0 <2>
application_alpha_timer_seconds_bucket{le="0.2"} 0.0 <2>
application_alpha_timer_seconds_bucket{le="1.0"} 1.0 <2>
application_alpha_timer_seconds_bucket{le="+Inf"} 2.0 <2> <3>
application_alpha_timer_seconds_count 2
application_alpha_timer_seconds_sum 6.0
application_alpha_timer_seconds{quantile="0.5"} 1.0
application_alpha_timer_seconds{quantile="0.7"} 5.0
application_alpha_timer_seconds{quantile="0.75"} 5.0
application_alpha_timer_seconds{quantile="0.8"} 5.0
----

<1> The Prometheus metric type is `histogram`. Both the quantiles/percentile and buckets are represented under this type.
<2> The `le` tag represents _less than_ and is for the defined buckets, which are converted to seconds.
<3> Prometheus requires that a `+Inf` bucket counts all hits.


[#course]
== Learn to develop applications with Open Liberty in the new "Essentials for Cloud-Native Java Application Development" course

The link:https://cognitiveclass.ai/courses/essentials-for-java-application-development-with-liberty[Essentials for Cloud-Native Java Application Development] course is published on the link:http://cognitiveclass.ai/[cognitiveclass.ai] site.

This course teaches you the essential skills and technologies to create a basic cloud-native Java application with Open Liberty. You'll learn about REST applications, CDI, externalizing application configuration, amd more. If you can achieve passing score of 80% on the finial assessment (20 multiple choices questions), you can get the link:https://www.credly.com/org/ibm/badge/liberty-developer-essentials[Liberty Developer Essentials] Credly badge.


// DO NOT MODIFY THIS LINE. </GHA-BLOG-TOPIC>



== Get Open Liberty 24.0.0.7 now

Available through <<run,Maven, Gradle, Docker, and as a downloadable archive>>.
