---
layout: post
title: "TITLE"
# Do NOT change the categories section
categories: blog
author_picture: https://avatars3.githubusercontent.com/dmuelle
author_github: https://github.com/dmuelle
seo-title: TITLE - makes sure it ends with - OpenLiberty.io
seo-description: DESCRIPTION
blog_description: DESCRIPTION
open-graph-image: https://openliberty.io/img/twitter_card.jpg
open-graph-image-alt: Open Liberty Logo
---
= TITLE
David Mueller <https://github.com/dmuelle>
:imagesdir: /
:url-prefix:
:url-about: /
//Blank line here is necessary before starting the body of the post.

// // // // // // // //
// In the preceding section:
// Do not insert any blank lines between any of the lines.
// Do not remove or edit the variables on the lines beneath the author name.
//
// "open-graph-image" is set to OL logo. Whenever possible update this to a more appropriate/specific image (For example if present an image that is being used in the post). However, it
// can be left empty which will set it to the default
//
// "open-graph-image-alt" is a description of what is in the image (not a caption). When changing "open-graph-image" to
// a custom picture, you must provide a custom string for "open-graph-image-alt".
//
// Replace TITLE with the blog post title eg: MicroProfile 3.3 is now available on Open Liberty 20.0.0.4
// Replace dmuelle with your GitHub username eg: lauracowen
// Replace DESCRIPTION with a short summary (~60 words) of the release (a more succinct version of the first paragraph of the post).
// Replace David Mueller with your name as you'd like it to be displayed,
// eg: LauraCowen
//
// For every link starting with "https://openliberty.io" in the post make sure to use
// {url-prefix}. e.g- link:{url-prefix}/guides/GUIDENAME[GUIDENAME]:
//
// If adding image into the post add :
// -------------------------
// [.img_border_light]
// image::img/blog/FILE_NAME[IMAGE CAPTION ,width=70%,align="center"]
// -------------------------
// "[.img_border_light]" = This adds a faint grey border around the image to make its edges sharper. Use it around screenshots but not
// around diagrams. Then double check how it looks.
// There is also a "[.img_border_dark]" class which tends to work best with screenshots that are taken on dark backgrounds.
// Change "FILE_NAME" to the name of the image file. Also make sure to put the image into the right folder which is: img/blog
// change the "IMAGE CAPTION" to a couple words of what the image is
// // // // // // // //

BETA_RELEASE_SUMMARY

// // // // // // // //
// Change the RELEASE_SUMMARY to an introductory paragraph. This sentence is really
// important because it is supposed to grab the readers attention.  Make sure to keep the blank lines
//
// Throughout the doc, replace 24.0.0.4-beta with the version number of Open Liberty, eg: 22.0.0.2-beta
// // // // // // // //

The link:{url-about}[Open Liberty] 24.0.0.4-beta includes the following beta features (along with link:{url-prefix}/docs/latest/reference/feature/feature-overview.html[all GA features]):

* <<SUB_TAG_0, Beta support for Java 22>>
* <<SUB_TAG_1, Preview of Jakarta Data (Milestone 3)>>

// // // // // // // //
// In the preceding section:
// Change SUB_FEATURE_TITLE to the feature that is included in this release and
// change the SUB_TAG_1/2/3 to the heading tags
//
// However if there's only 1 new feature, delete the previous section and change it to the following sentence:
// "The link:{url-about}[Open Liberty] 24.0.0.4-beta includes SUB_FEATURE_TITLE"
// // // // // // // //

See also link:{url-prefix}/blog/?search=beta&key=tag[previous Open Liberty beta blog posts].

// // // // DO NOT MODIFY THIS COMMENT BLOCK <GHA-BLOG-TOPIC> // // // // 
// Blog issue: https://github.com/OpenLiberty/open-liberty/issues/27856
// Contact/Reviewer: gjwatts
// // // // // // // // 
[#SUB_TAG_0]
== Beta support for Java 22

1. Which Liberty feature(s) does your update relate to? 
    
    Human-readable name (eg WebSockets feature): All features
   
    Short feature name (eg websockets-1.0):  All
   
   
    </GHA-BLOG-RELATED-FEATURES>

    <GHA-BLOG-TARGET-PERSONA>
2. Who is the target persona? Who do you expect to use the update? eg application developer, operations.  
     Application developers and operations staff
    
    </GHA-BLOG-TARGET-PERSONA>
   
    <GHA-BLOG-SUMMARY>
3. Provide a summary of the update, including the following points:
   
   - A sentence or two that introduces the update to someone new to the general technology/concept.

   - What was the problem before and how does your update make their life better? (Why should they care?)
   
   - Briefly explain how to make your update work. Include screenshots, diagrams, and/or code snippets, and provide a `server.xml` snippet.
   
   - Where can they find out more about this specific update (eg Open Liberty docs, Javadoc) and/or the wider technology?


Java 22 is the latest release of Java, expected out in March 2024.  It contains new features and enhancements over previous versions of Java.  However, Java 22 is not a long term support (LTS) release and support for it will be dropped once the next version of Java is supported.  It offers some new functionality and changes that you are going to want to check out for yourself.

Here are the link:https://openjdk.org/projects/jdk/22/[JEP changes in Java 22]:
423: link:https://openjdk.org/jeps/423[Region Pinning for G1]
447: link:https://openjdk.org/jeps/447[Statements before super(...) (Preview)]
454: link:https://openjdk.org/jeps/454[Foreign Function & Memory API]
456: link:https://openjdk.org/jeps/456[Unnamed Variables & Patterns]
457: link:https://openjdk.org/jeps/457[Class-File API (Preview)]
458: link:https://openjdk.org/jeps/458[Launch Multi-File Source-Code Programs]
459: link:https://openjdk.org/jeps/459[String Templates (Second Preview)]
460: link:https://openjdk.org/jeps/460[Vector API (Seventh Incubator)]
461: link:https://openjdk.org/jeps/461[Stream Gatherers (Preview)]
462: link:https://openjdk.org/jeps/462[Structured Concurrency (Second Preview)]
463: link:https://openjdk.org/jeps/463[Implicitly Declared Classes and Instance Main Methods (Second Preview)]
464: link:https://openjdk.org/jeps/464[Scoped Values (Second Preview)]

Take advantage of the new changes in Java 22 in Open Liberty now and get more time to review your applications, microservices and runtime environments on your favorite server runtime!

To start using Java 22 with Open Liberty, just link:https://jdk.java.net/22/[download the latest release of Java 22], download and install the link:https://openliberty.io/downloads/#runtime_betas[24.0.0.4-beta] version of Open Liberty, edit your Liberty server's link:https://openliberty.io/docs/latest/reference/config/server-configuration-overview.html#server-env[server.env file] to point JAVA_HOME to your Java 22 installation and start testing today!

For more information on Java 22, please visit the Java 22 link:https://jdk.java.net/22/release-notes[release notes page], link:https://download.java.net/java/early_access/jdk22/docs/api/[API Javadoc page] or link:https://jdk.java.net/22/[download page].
For more information on Open Liberty, please visit our link:https://openliberty.io/docs[documentation page].

*Note: As we work toward full Java 22 support, please bear with any of our functionality that might not be ready yet.
    
    
// DO NOT MODIFY THIS LINE. </GHA-BLOG-TOPIC> 

// // // // DO NOT MODIFY THIS COMMENT BLOCK <GHA-BLOG-TOPIC> // // // // 
// Blog issue: https://github.com/OpenLiberty/open-liberty/issues/27808
// Contact/Reviewer: njr-11
// // // // // // // // 
[#SUB_TAG_1]
== Preview of Jakarta Data (Milestone 3)

1. Which Liberty feature(s) does your update relate to? 
    
    Human-readable name (eg WebSockets feature): 
Jakarta Data
   
    Short feature name (eg websockets-1.0):  
data-1.0
   
    </GHA-BLOG-RELATED-FEATURES>

    <GHA-BLOG-TARGET-PERSONA>
2. Who is the target persona? Who do you expect to use the update? eg application developer, operations.  
         Application developer
    
    </GHA-BLOG-TARGET-PERSONA>
   
    <GHA-BLOG-SUMMARY>
3. Provide a summary of the update, including the following points:
   
   - A sentence or two that introduces the update to someone new to the general technology/concept.

   - What was the problem before and how does your update make their life better? (Why should they care?)
   
   - Briefly explain how to make your update work. Include screenshots, diagrams, and/or code snippets, and provide a `server.xml` snippet.
   
   - Where can they find out more about this specific update (eg Open Liberty docs, Javadoc) and/or the wider technology?  
 
Jakarta Data is a new Jakarta EE specification being developed in the open that aims to standardize the popular Data Repository pattern across a variety of providers. Open Liberty includes the Jakarta Data 1.0 Milestone 3 release, which adds the ability the Static Metamodle and the ability to annotatively compose `Find` methods. The Open Liberty beta includes a test implementation of Jakarta Data that we are using to experiment with proposed specification features so that developers can try out these features and provide feedback to influence the Jakarta Data 1.0 specification as it continues to be developed. The test implementation currently works with relational databases and operates by redirecting repository operations to the built-in Jakarta Persistence provider.

Jakarta Data 1.0 Milestone 3 introduces the concept of a Static Metamodel, which allows for more type-safe usage, and introduces the ability to define repository find methods with the `@Find` annotation. To use these capabilities, you will need an Entity and a Repository.

Start by defining an entity class that corresponds to your data. With relational databases, the entity class corresponds to a database table and the entity properties (public methods and fields of the entity class) generally correspond to the columns of the table. An entity class can be:

- annotated with `jakarta.persistence.Entity` and related annotations from Jakarta Persistence
- a Java class without entity annotations, in which case the primary key is inferred from an entity property named `id` or ending with `Id` and an entity property named `version` designates an automatically incremented version column.

You define one or more repository interfaces for an entity, annotate those interfaces as `@Repository` and inject them into components via `@Inject`. The Jakarta Data provider supplies the implementation of the repository interface for you.

Here's a simple entity,

```
@Entity
public class Product {
    @Id
    public long id;

    public boolean isDiscounted;

    public String name;

    public float price;

    @Version
    public long version;
}
```

Here is a repository that defines operations relating to the entity. Your repository interface can inherit from built-in interfaces such as `BasicRepository` and `CrudRepository` to gain a variety of general purpose repository methods for inserting, updating, deleting and querying for entities, but in this case we will define all of the methods ourselves, taking advantage of the new life cycle annotations.

```
@Repository(dataStore = "java:app/jdbc/my-example-data")
public interface Products extends BasicRepository<Product, Long> {
    @Insert
    Product add(Product newProduct);

    // parameter based query that requires compilation with -parameters to preserve parameter names
    @Find
    Optional<Product> find(long id);

    // parameter based query that does not require -parameters because it explicitly specifies the name
    @Find
    Page<Product> find(@By("isDiscounted") boolean onSale,
                       PageRequest<Product> pageRequest);

    // query-by-method name pattern:
    List<Product> findByNameIgnoreCaseContains(String searchFor, Order<Product> orderBy);

    // query via JPQL:
    @Query("UPDATE Product o SET o.price = o.price - (?2 * o.price), o.isDiscounted = true WHERE o.id = ?1")
    boolean discount(long productId, float discountRate);
}
```

Observe that the repository interface includes type parameters in `PageRequest<Product>` and `Order<Product>`.  This helps ensure that the page request and sort criteria are for a `Product` entity rather than some other entity.  To accomplish this, you can optionally define a Static Metamodel class for the entity (or various IDEs might generate one for you after the 1.0 specification is actually released).  Here is one that can be used with the `Product` entity,

```
@StaticMetamodel(Product.class)
public class _Product {
    public static volatile SortableAttribute<Product> id;
    public static volatile SortableAttribute<Product> isDiscounted;
    public static volatile TextAttribute<Product> name;
    public static volatile SortableAttribute<Product> price;
    public static volatile SortableAttribute<Product> version;

    // The static metamodel can also have String constants for attribute names,
    // but those are omitted from this example
}
```

Here is an example of the repository and static metamodel being used,

```
@DataSourceDefinition(name = "java:app/jdbc/my-example-data",
                      className = "org.postgresql.xa.PGXADataSource",
                      databaseName = "ExampleDB",
                      serverName = "localhost",
                      portNumber = 5432,
                      user = "${example.database.user}",
                      password = "${example.database.password}")
public class MyServlet extends HttpServlet {
    @Inject
    Products products;

    protected void doGet(HttpServletRequest req, HttpServletResponse resp)
            throws ServletException, IOException {
        // Insert:
        Product prod = ...
        prod = products.add(prod);

        // Find one entity:
        prod = products.find(productId).orElseThrow();

        // Find all, sorted:
        List<Product> all = products.findByNameIgnoreCaseContains(searchFor, Order.by(
                                     _Product.price.desc(),
                                     _Product.name.asc(),
                                     _Product.id.asc()));

        // Find the first 20 most expensive products on sale:
        Page<Product> page1 = products.find(onSale, Order.by(_Product.price.desc(),
                                                             _Product.name.asc(),
                                                             _Product.id.asc())
                                                         .pageSize(20));
        ...
    }
}
```
    
    
// DO NOT MODIFY THIS LINE. </GHA-BLOG-TOPIC> 



To enable the new beta features in your app, add them to your `server.xml`:

[source, xml]
----

----

[#run]
=== Try it now

To try out these features, update your build tools to pull the Open Liberty All Beta Features package instead of the main release. The beta works with Java SE 21, Java SE 17, Java SE 11, and Java SE 8.
// // // // // // // //
// In the preceding section:
// Check if a new non-LTS Java SE version is supported that needs to be added to the list (21, 17, 11, and 8 are LTS and will remain for a while)
// https://openliberty.io/docs/latest/java-se.html
//
// In the following section:
// Check if a new MicroProfile or Jakarta version is in beta that could replace the example values in the codeblock
// // // // // // // //

If you're using link:{url-prefix}/guides/maven-intro.html[Maven], you can install the All Beta Features package using:

[source,xml]
----
<plugin>
    <groupId>io.openliberty.tools</groupId>
    <artifactId>liberty-maven-plugin</artifactId>
    <version>3.8.2</version>
    <configuration>
        <runtimeArtifact>
          <groupId>io.openliberty.beta</groupId>
          <artifactId>openliberty-runtime</artifactId>
          <version>24.0.0.4-beta</version>
          <type>zip</type>
        </runtimeArtifact>
    </configuration>
</plugin>
----

You must also add dependencies to your pom.xml file for the beta version of the APIs that are associated with the beta features that you want to try. For example, the following block adds dependencies for two example beta APIs:

[source,xml]
----
<dependency>
    <groupId>org.example.spec</groupId>
    <artifactId>exampleApi</artifactId>
    <version>7.0</version>
    <type>pom</type>
    <scope>provided</scope>
</dependency>
<dependency>
    <groupId>example.platform</groupId>
    <artifactId>example.example-api</artifactId>
    <version>11.0.0</version>
    <scope>provided</scope>
</dependency>
----

Or for link:{url-prefix}/guides/gradle-intro.html[Gradle]:

[source,gradle]
----
buildscript {
    repositories {
        mavenCentral()
    }
    dependencies {
        classpath 'io.openliberty.tools:liberty-gradle-plugin:3.6.2'
    }
}
apply plugin: 'liberty'
dependencies {
    libertyRuntime group: 'io.openliberty.beta', name: 'openliberty-runtime', version: '[24.0.0.4-beta,)'
}
----
// // // // // // // //
// In the preceding section:
// Replace the Maven `3.8.2` with the latest version of the plugin: https://search.maven.org/artifact/io.openliberty.tools/liberty-maven-plugin
// Replace the Gradle `3.6.2` with the latest version of the plugin: https://search.maven.org/artifact/io.openliberty.tools/liberty-gradle-plugin
// TODO: Update GHA to automatically do the above.  If the maven.org is problematic, then could fallback to using the GH Releases for the plugins
// // // // // // // //

Or if you're using link:{url-prefix}/docs/latest/container-images.html[container images]:

[source]
----
FROM icr.io/appcafe/open-liberty:beta
----

Or take a look at our link:{url-prefix}/downloads/#runtime_betas[Downloads page].

If you're using link:https://plugins.jetbrains.com/plugin/14856-liberty-tools[IntelliJ IDEA], link:https://marketplace.visualstudio.com/items?itemName=Open-Liberty.liberty-dev-vscode-ext[Visual Studio Code] or link:https://marketplace.eclipse.org/content/liberty-tools[Eclipse IDE], you can also take advantage of our open source link:https://openliberty.io/docs/latest/develop-liberty-tools.html[Liberty developer tools] to enable effective development, testing, debugging and application management all from within your IDE.

For more information on using a beta release, refer to the link:{url-prefix}docs/latest/installing-open-liberty-betas.html[Installing Open Liberty beta releases] documentation.

[#feedback]
== We welcome your feedback

Let us know what you think on link:https://groups.io/g/openliberty[our mailing list]. If you hit a problem, link:https://stackoverflow.com/questions/tagged/open-liberty[post a question on StackOverflow]. If you hit a bug, link:https://github.com/OpenLiberty/open-liberty/issues[please raise an issue].
