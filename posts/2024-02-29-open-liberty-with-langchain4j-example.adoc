---
layout: post
title: "Run LangChain4J in Jakarta EE and MicroProfile application on Open Liberty"
# Do NOT change the categories section
categories: blog
author_picture: https://avatars3.githubusercontent.com/gkwan-ibm
author_github: https://github.com/gkwan-ibm
seo-title: Run LangChain4J in Jakarta EE and MicroProfile application on Open Liberty
seo-description: Experience AI technology in an Jakarta EE and MicroProfile application running on Open Liberty by using LangChain4J APIs.
blog_description: "Experience AI technology in an Jakarta EE and MicroProfile application running on Open Liberty by using LangChain4J APIs."
open-graph-image: https://openliberty.io/img/twitter_card.jpg
open-graph-image-alt: Open Liberty Logo
---
= Run LangChain4J in Jakarta EE and MicroProfile application on Open Liberty
Gilbert Kwan <https://github.com/gkwan-ibm>
:imagesdir: /
:url-prefix:
:url-about: /



"Large language models (LLMs) are a category of foundation models trained on immense amounts of data making them capable of understanding and generating natural language and other types of content to perform a wide range of tasks." ... _from https://www.ibm.com/topics/large-language-models_

https://github.com/langchain4j/langchain4j[LangChain4J APIs] provide the capablities to intergate LLMs into your Java application for different AI platforms, such as OpenAI and Hugging Face, etc.

If you want to experience AI technologies, you can try out the `jakartaee-microprofile-example` project in the https://github.com/langchain4j/langchain4j-examples[langchain4j-examples] GitHub repository. It is an exemplar application that demostrates how to use LangChain4j APIs in Jakarta EE and MicroProfile application on Open Liberty.


== Try out the jakartaee-microprofile-example application

Before you clone the application to your machine, install JDK 17 and ensure that your `JAVA_HOME` system variable is set.  You can make use of the https://developer.ibm.com/languages/java/semeru-runtimes/downloads[IBM Semeru Runtime] as your chosen Java runtime. This runtime offers performance benefits from deep technology investment in projects such as Eclipse OpenJ9 and is available across a wide variety of hardware and software platforms. To find out more about IBM Semeru Runtime, see https://openliberty.io/blog/2022/08/19/open-liberty-semeru-performance.html[Open Liberty and Semeru Runtimes, cloud-native performance that matters].

The application uses Hugging Face. You need to get a Hugging Face API Key:

* Sign up and login to https://huggingface.co
* Go to Access Tokens by https://huggingface.co/settings/tokens
* New a Read token

To access the repository remotely you'll need to install https://git-scm.com/book/en/v2/Getting-Started-Installing-Git[Git] if you haven't already. You can clone the `langchain4j-examples` GitHub repository to your local machine by running:

[source]
----
git clone https://github.com/langchain4j/langchain4j-examples.git
----

=== Environment Set Up

To run the application, navigate to the `jakartaee-microprofile-example` directory:

[source]
----
cd langchain4j-examples/jakartaee-microprofile-example
----

and set the environment variables:

[source]
----
export JAVA_HOME=<your Java 17 home path>
export HUGGING_FACE_API_KEY=<your Hugging Face read token>
----

=== Start the application

To start the application, use the provided Maven wrapper to run the https://openliberty.io/docs/latest/development-mode.html[Liberty dev mode]:


[source]
----
./mvnw liberty:dev
----

After you see the following message, the application is ready:

----
************************************************************************
*    Liberty is running in dev mode.
*        Automatic generation of features: [ Off ]
*        h - see the help menu for available actions, type 'h' and press Enter.
*        q - stop the server and quit dev mode, press Ctrl-C or type 'q' and press Enter.
*        
*    Liberty server port information:
*        Liberty server HTTP port: [ 9080 ]
*        Liberty server HTTPS port: [ 9443 ]
*        Liberty debug port: [ 7777 ]
************************************************************************
----

To ensure the application has started successfully, you can run the tests by pressing the `enter/return` key from the command-line session. If the tests pass, you should see a similar output to the following example:

----
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running it.dev.langchan4j.example.ChatServiceIT
[INFO] ...
[INFO] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.439 s...
[INFO] ...
[INFO] Running it.dev.langchan4j.example.ModelResourceIT
[INFO] Tests run: 3, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.733 s...
[INFO] 
[INFO] Results:
[INFO] 
[INFO] Tests run: 4, Failures: 0, Errors: 0, Skipped: 0
----

=== Access the application

Once the application is running, you can access it through a browser of your choice at http://localhost:9080/ and start experimenting with it.

image::/img/blog/langchain4j-example-chat-room.png[Chat Room  of LangChain4J Jakarta EE and MicroProfile example,width=70%,align="center"]

You can type in any text that you want to chat with the AI agent. Here are some suggested messages:

* `What is large language models?`
* `tell me more`
* `which are the top used models?`
* `any documentation?`

== What are Jakarta EE and MicroProfile features used?

To connect to the AI provider, such as Hugging Face in the application, an API key is required. For security practice, it is not hard-coded in either the code or properties file. The application externalizes the API key and the langchain4j model properties with the MicroProfile Config feature that helps microservices to run in different environments without code changes.

[java]
----
    @Inject
    @ConfigProperty(name = "hugging.face.api.key")
    private String HUGGING_FACE_API_KEY;

    @Inject
    @ConfigProperty(name = "chat.model.id")
    private String CHAT_MODEL_ID;

    @Inject
    @ConfigProperty(name = "chat.model.timeout")
    private Integer TIMEOUT;

    @Inject
    @ConfigProperty(name = "chat.model.max.token")
    private Integer MAX_NEW_TOKEN;

    @Inject
    @ConfigProperty(name = "chat.model.temperature")
    private Double TEMPERATURE;

    @Inject
    @ConfigProperty(name = "chat.memory.max.messages")
    private Integer MAX_MESSAGES;
----

== Nice work! Where to next?

Check out the https://openliberty.io/guides/[Open Liberty guides] for more information and interactive tutorials that walk you through using more Jakarta EE and MicroProfile APIs with Open Liberty. 

== Helpful links
* link:https://openliberty.io/guides/jakarta-websocket.html[Bidirectional communication between services using Jakarta WebSocket]
* link:https://openliberty.io/guides/microprofile-config.html[Configuring microservices]
* link:https://openliberty.io/guides/microprofile-metrics.html[Providing metrics from a microservice]


